(()=>{"use strict";const e=class{constructor(e,t,s,r){let{link:n,name:i}=e;this._cardName=i,this._cardLink=n,this._cardTemplate=t,this._handleCardClick=s,this._checkCardsQuantity=r}render=()=>(this._createCard(),this._card);_setEventListeners=()=>{this._cardImage.addEventListener("click",(()=>this._handleCardClick(this._cardName,this._cardLink))),this._cardLikeButton=this._card.querySelector(".card__like-button"),this._cardLikeButton.addEventListener("click",this._handleLikeButton),this._cardDeleteButton=this._card.querySelector(".card__delete-button"),this._cardDeleteButton.addEventListener("click",this._handleDeleteButton)};_handleLikeButton=e=>{e.target.classList.toggle("card__like-button_active")};_handleDeleteButton=()=>{this._card.remove(),this._checkCardsQuantity()};_getCard=()=>this._cardTemplate.querySelector(".card").cloneNode(!0);_createCard=()=>{this._card=this._getCard(),this._card.setAttribute("name",this._cardName),this._cardImage=this._card.querySelector(".card__image"),this._cardImage.src=this._cardLink,this._cardImage.alt=this._cardName,this._card.querySelector(".card__name").textContent=this._cardName,this._setEventListeners()}},t=class{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=t}addItem(e){this._container.prepend(e)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}};class s{constructor(e){this._popup=document.querySelector(e)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{e.target.classList.contains("popup__overlay")&&this.close(),e.target.classList.contains("popup__close-button")&&this.close()}))}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",(e=>this._handleEscClose(e)))}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",(e=>this._handleEscClose(e)))}_handleEscClose(e){"Escape"===e.key&&this.close()}}class r extends s{constructor(e,t){super(e),this._formSubmit=t,this._form=this._popup.querySelector(".form")}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{e.target.classList.contains("popup__overlay")&&this.close(),e.target.classList.contains("popup__close-button")&&this.close()})),this._form.addEventListener("submit",(e=>this._formSubmit(e,this._getInputValues())))}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",(e=>this._handleEscClose(e))),this._form.reset()}_getInputValues(){return this._formValues={},Array.from(this._popup.querySelectorAll("input")).forEach((e=>this._formValues[e.name]=e.value)),this._formValues}}const n=document.querySelector(".profile__edit-button"),i=document.querySelector(".edit-popup__input_type_name"),o=document.querySelector(".edit-popup__input_type_profession"),a=document.querySelector(".profile__name"),c=document.querySelector(".profile__subtitle"),d=document.querySelector(".elements__list"),u=document.querySelector(".profile__add-button"),l=document.querySelector("#card-template").content,_={},p=new t({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:t=>{const s=new e(t,l,y,L);p.addItem(s.render())}},d),h=new class{constructor(e){let{name:t,description:s}=e;this._name=t,this._description=s}getUserInfo(){return{name:this._name.textContent,description:this._description.textContent}}setUserInfo(e,t){this._name.textContent=e,this._description.textContent=t}}({name:a,description:c}),m=new r(".edit-popup",(function(e,t){e.preventDefault();const s=t["edit-name"],r=t["edit-profession"];h.setUserInfo.bind(h)(s,r),m.close()}));m.setEventListeners();const v=new r(".new-card-popup",(function(s,r){s.preventDefault();const n=[{link:r["new-card-image"],name:r["new-card-name"]}],i=new t({items:n,renderer:t=>{const s=new e(t,l,y,L);i.addItem(s.render())}},d);i.renderItems(),L(),v.close()}));v.setEventListeners();const f=new class extends s{constructor(e){super(e)}open(e,t){this._popup.querySelector(".image-popup__image").src=t,this._popup.querySelector(".image-popup__image").alt=e,this._popup.querySelector(".image-popup__title").textContent=e,this._popup.classList.add("popup_opened"),document.addEventListener("keydown",(e=>this._handleEscClose(e)))}}(".image-popup");function y(e,t){f.open(e,t)}function L(){document.querySelectorAll(".card").length<3?d.classList.add("elements__list_few-cards"):d.classList.remove("elements__list_few-cards")}var E;f.setEventListeners(),n.addEventListener("click",(()=>{_.profileEdit.resetValidation();const e=h.getUserInfo();i.value=e.name,o.value=e.description,m.open()})),u.addEventListener("click",(()=>{_["new-card"].resetValidation(),v.open()})),E={formSelector:".form",inputSelector:".popup__input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_disabled",inputError:"input__error",inputErrorText:"input__error-text"},Array.from(document.querySelectorAll(E.formSelector)).forEach((e=>{const t=new class{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputError=e.inputError,this._inputErrorText=e.inputErrorText,this._form=t}enableValidation=()=>{this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()};resetValidation=()=>{this._toggleButtonState(!0),this._inputList.forEach((e=>{e.value="",this._hideError(e)}))};_setEventListeners=()=>{this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._submitButton=this._form.querySelector(this._submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))};_toggleButtonState=e=>{this._hasInvalidInput()||e?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.setAttribute("disabled",!0)):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.removeAttribute("disabled",!0))};_hasInvalidInput=()=>this._inputList.some((e=>!e.validity.valid));_checkInputValidity=e=>{e.validity.valid?this._hideError(e):this._showError(e,e.validationMessage)};_showError=(e,t)=>{const s=this._form.querySelector(`#error__${e.name}`);e.classList.add(this._inputError),s.textContent=t,s.classList.add(this._inputErrorText)};_hideError=e=>{const t=this._form.querySelector(`#error__${e.name}`);e.classList.remove(this._inputError),t.textContent="",t.classList.remove(this._inputErrorText)}}(E,e),s=e.getAttribute("name");_[s]=t,t.enableValidation()})),p.renderItems()})();